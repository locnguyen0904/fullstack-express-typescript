import {{pascalCase name}}Service from '@/api/{{kebabCase name}}/{{kebabCase name}}.service';

describe('{{pascalCase name}}Service', () => {
  const {{camelCase name}}Repository = {
    create: jest.fn(),
    findById: jest.fn(),
    findAll: jest.fn(),
    updateById: jest.fn(),
    deleteById: jest.fn(),
    softDeleteById: jest.fn(),
    restoreById: jest.fn(),
  };

  const redis = {
    isConnected: false,
    get: jest.fn(),
    set: jest.fn(),
    delByPrefix: jest.fn(),
  };

  const {{camelCase name}}Service = new {{pascalCase name}}Service(
    {{camelCase name}}Repository as any,
    redis as any
  );

  beforeEach(() => {
    jest.clearAllMocks();
  });

  describe('create', () => {
    it('should create a {{camelCase name}}', async () => {
      const data = { name: 'Test {{pascalCase name}}' };
      {{camelCase name}}Repository.create.mockResolvedValue({ ...data, _id: '1' });

      const result = await {{camelCase name}}Service.create(data);

      expect({{camelCase name}}Repository.create).toHaveBeenCalledWith(data);
      expect(result).toEqual({ ...data, _id: '1' });
    });
  });

  describe('findById', () => {
    it('should return a {{camelCase name}} by id', async () => {
      const expected = { _id: '1', name: 'Test' };
      {{camelCase name}}Repository.findById.mockResolvedValue(expected);

      const result = await {{camelCase name}}Service.findById('1');

      expect(result).toEqual(expected);
    });

    it('should return null when not found', async () => {
      {{camelCase name}}Repository.findById.mockResolvedValue(null);

      const result = await {{camelCase name}}Service.findById('999');

      expect(result).toBeNull();
    });
  });

  describe('update', () => {
    it('should update a {{camelCase name}}', async () => {
      const updated = { _id: '1', name: 'Updated' };
      {{camelCase name}}Repository.updateById.mockResolvedValue(updated);

      const result = await {{camelCase name}}Service.update('1', { name: 'Updated' });

      expect(result).toEqual(updated);
    });
  });

  describe('softDelete', () => {
    it('should soft delete a {{camelCase name}}', async () => {
      const deleted = { _id: '1', name: 'Test', deletedAt: new Date() };
      {{camelCase name}}Repository.softDeleteById.mockResolvedValue(deleted);

      const result = await {{camelCase name}}Service.softDelete('1');

      expect(result).toEqual(deleted);
    });
  });
});
