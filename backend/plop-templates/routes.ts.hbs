import './{{kebabCase name}}.doc';

import { Router } from 'express';
import validate from 'express-zod-safe';
import { container } from 'tsyringe';

import { idParamSchema, listQuerySchema } from '@/common';
import { authorize, isAuth } from '@/middlewares';

import {{pascalCase name}}Controller from './{{kebabCase name}}.controller';
import { create{{pascalCase name}}Schema, update{{pascalCase name}}Schema } from './{{kebabCase name}}.validation';

const router: Router = Router();
const controller = container.resolve({{pascalCase name}}Controller);

router.get(
  '/',
  validate({ query: listQuerySchema }),
  controller.findAll.bind(controller)
);
router.get(
  '/:id',
  validate({ params: idParamSchema }),
  controller.findOne.bind(controller)
);

router.post(
  '/',
  isAuth,
  authorize('admin'),
  validate({ body: create{{pascalCase name}}Schema }),
  controller.create.bind(controller)
);
router.put(
  '/:id',
  isAuth,
  authorize('admin'),
  validate({ params: idParamSchema, body: update{{pascalCase name}}Schema }),
  controller.update.bind(controller)
);
router.delete(
  '/:id',
  isAuth,
  authorize('admin'),
  validate({ params: idParamSchema }),
  controller.delete.bind(controller)
);

export default router;
